{% extends "base.html" %}
{% block content %}

<h1>Neue {{ typ.replace('_', ' ')|title }} zum PC hinzufÃ¼gen</h1>

<!-- ðŸ” Suchleiste -->
<input
  type="text"
  id="searchInput"
  class="form-control"
  placeholder="Suchen nach Marke oder Modell..."
  style="margin-bottom: 20px;"
  onkeyup="filterComponents()"
>

<div class="row">
  {% for item in komponenten %}
  <div class="col-sm-4 component-card"
       data-search="{{ (item.marke ~ ' ' ~ item.modell)|lower }}">
    <div class="panel panel-default">
      <div class="panel-heading">
        <strong>{{ item.marke }} {{ item.modell }}</strong>
      </div>

      <div class="panel-body">
        {% if item.preis %}
        <p><strong>{{ item.preis }} CHF</strong></p>
        {% endif %}

        {% if typ == "gpu" and item.vram %}
        <p>VRAM: {{ item.vram }} GB</p>
        {% endif %}

        {% if typ == "ram" and item.speichermenge_gb %}
        <p>RAM: {{ item.speichermenge_gb }} GB Â· CL {{ item.cl_rating }}</p>
        {% endif %}

        {% if typ == "psu" and item.watt %}
        <p>Leistung: {{ item.watt }} W</p>
        {% endif %}

        {% if typ == "ssd" and item.speichermenge_gb %}
        <p>Speicher: {{ item.speichermenge_gb }} GB</p>
        {% endif %}

        {% if typ == "cpu" and item.frequenz_ghz %}
        <p>Takt: {{ item.frequenz_ghz }} GHz Â· {{ item.watt }} W</p>
        {% endif %}

        <!-- Button zum HinzufÃ¼gen -->
        <a href="{{ url_for('add_component', pc_id=pc_id, item_id=item.id) }}" 
           class="btn btn-success btn-block" style="margin-top: 10px;">
          HinzufÃ¼gen
        </a>

        {% if not item.pc_id %}
          <form action="{{ url_for('delete_component', item_id=item.id) }}" method="post"
            onsubmit="return confirm('Bist du sicher, dass du diese Komponente komplett lÃ¶schen willst?');">
            <button type="submit" class="btn btn-danger btn-block">LÃ¶schen</button>
          </form>
        {% endif %}
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<hr>

<div class="text-center">
  <a href="{{ url_for('pc_detail', pc_id=pc_id) }}"
     class="btn btn-default">
    ZurÃ¼ck zur PC-Ãœbersicht
  </a>
</div>

<script>
function filterComponents() {
  const input = document.getElementById("searchInput").value.toLowerCase();
  const cards = document.getElementsByClassName("component-card");

  for (let i = 0; i < cards.length; i++) {
    const text = cards[i].getAttribute("data-search");
    cards[i].style.display = text.includes(input) ? "" : "none";
  }
}
</script>

{% endblock %}
